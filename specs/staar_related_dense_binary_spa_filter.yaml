scenario_id: staar_related_dense_binary_spa_filter
description: STAAR-Binary-SPA workflow for related samples using dense GRM with SPA prefilter enabled
r_entry_point: fit_null_glmmkin_Binary_SPA(Y ~ X1 + X2, data=binary_pheno_related, kins=kins_dense) then STAAR_Binary_SPA(..., SPA_p_filter=TRUE)
python_entry_point: staar_related_dense_binary_spa(example, seed=600, SPA_p_filter=True, p_filter_cutoff=0.05)

inputs:
  dataset: example
  dataset_fingerprint: baselines/example_fingerprint.json
  simulation_metadata: baselines/example_sim_metadata.json

parameters:
  seed: 600
  rare_maf_cutoff: 0.05
  case_quantile: 0.95
  SPA_p_filter: true
  p_filter_cutoff: 0.05
  use_precomputed_artifacts: true

sentinels:
  - name: num_variant
    file: baselines/related_dense_binary_spa_filter_sentinels.json
    path: $.num_variant
    comparison: scalar_approx
    rtol: 1e-8
    atol: 0

  - name: cMAC
    file: baselines/related_dense_binary_spa_filter_sentinels.json
    path: $.cMAC
    comparison: scalar_approx
    rtol: 1e-8
    atol: 0

  - name: case_count
    file: baselines/related_dense_binary_spa_filter_sentinels.json
    path: $.case_count
    comparison: scalar_approx
    rtol: 1e-8
    atol: 0

  - name: results_STAAR_B
    file: baselines/related_dense_binary_spa_filter_sentinels.json
    path: $.results_STAAR_B
    comparison: scalar_approx
    rtol: 1e-6
    atol: 1e-8

  - name: results_STAAR_B_1_25
    file: baselines/related_dense_binary_spa_filter_sentinels.json
    path: $.results_STAAR_B_1_25
    comparison: mapping_approx
    rtol: 1e-6
    atol: 1e-8

  - name: results_STAAR_B_1_1
    file: baselines/related_dense_binary_spa_filter_sentinels.json
    path: $.results_STAAR_B_1_1
    comparison: mapping_approx
    rtol: 1e-6
    atol: 1e-8
